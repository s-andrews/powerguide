---
title: "Power Analysis"
author: "Power Guide (github.com/s-andrews/powerguide)"
date: "26 September 2017"
output: 
  html_document:
    theme: flatly
    toc: true
    toc_depth: 4
    toc_float: 
      collapsed: false
---

```{{r setup, include=FALSE}}
knitr::opts_chunk$set(echo = TRUE)
```

[![](powerguide_logo.png)](index.html)

#Power Analysis

This document provides an automated power analysis for use during experimental design.  The output below shows the R code used to perform the power analysis along with an exploration of some of the variables supplied to show what options you would have were some of the values entered later proved to be somewhat inaccurate.

This document was generated by the PowerGuide power analysis system.  If you have any questions or suggestions about this system please use the bug reporting tools at https://github.com/s-andrews/powerguide/issues to let us know about these, or send them directly to simon.andrews\@babraham.ac.uk.


#### Assumptions

All power analysis is based on a set of assumptions, either based on previous pilot experiments, or prior knowledge of the behaviour of variables in the scientific literature.  The values presented here were collected from the PowerGuide web interface and have not been automatically generated by this system.

The results produced here are only as accurate as the values entered in this assumptions section.

The assumptions made in this particular analysis are:

* Type of data : Continuous

* Behaviour : Normally distributed

* Number of conditions: 1

* Power of detection: {power}

* Signficnace threshold : {significance}

* Minimum biologically relevant difference : {difference}

* Estimated standard deviation : {variance}

```{{r}}
  power.of.detection <- {power}
  significance.threshold <- {significance}
  minimum.difference <- {difference}
  standard.deviation <- {variance}
```

## Basic Power Analysis


```{{r}}
power.t.test(
  type = "one.sample",
  alternative = "two.sided",
  power = power.of.detection,
  sig.level = significance.threshold,
  delta = minimum.difference,
  sd = standard.deviation
) -> power.result

power.result
```

This shows that with the assumptions presented here you would need **`r I(ceiling(power.result$n))`** samples in each group to do what you want.


## Exploration

Since some of the values you put into the power analysis might well be estimates we can also look at the effect it would have on the sample size if some of the estimates were to prove inaccurate.


#### Varying Standard Deviation

Standard deviation is by far the hardest parameter to estimate in a power analysis since there is often little or no data to support the value provided.  Here we can look at the effect which varying this would have.

```{{r fig.height=7, fig.width=7}}

sd.range <- seq(from=standard.deviation/5, to=standard.deviation*5, length.out= 100)
sapply(sd.range,function(x) power.t.test(
                              type = "one.sample",
                              alternative = "two.sided",
                              power = power.of.detection,
                              sig.level = significance.threshold,
                              delta = minimum.difference,
                              sd = x)$n
) -> n.values


plot(
  sd.range,
  n.values,
  las=1,
  xlab="Standard Deviation",
  ylab="Number of samples required per group",
  main="Effect on sample size of varying Standard Deviation",
  log="y"
    )

abline(v=standard.deviation,col="red2")
abline(h=power.result$n, col="red2")



```


#### Varying Minimum Difference

Sometimes, if an initial power analysis provides unrealisitic sample numbers it can be useful what sort of effect size you could actually detect with different sample sizes.

```{{r fig.height=7, fig.width=7}}

effect.range <- seq(from=minimum.difference/5, to=minimum.difference*5, length.out= 100)
sapply(effect.range,function(x) power.t.test(
                              type = "one.sample",
                              alternative = "two.sided",
                              power = power.of.detection,
                              sig.level = significance.threshold,
                              delta = x,
                              sd = standard.deviation)$n
) -> n.values


plot(
  effect.range,
  n.values,
  las=1,
  xlab="Minimum Effect Size",
  ylab="Number of samples required per group",
  main="Effect on sample size of varying minimum effect size",
  log = "y"
    )

abline(v=minimum.difference,col="red2")
abline(h=power.result$n, col="red2")



```

![](powerguide_logo.png)

![](babraham.png)





